"""
Celebrations Prompts.
–ü—Ä–æ–º–ø—Ç—ã –¥–ª—è –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–π —Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è –∏ –≥–æ–¥–æ–≤—â–∏–Ω–∞–º–∏.
"""

from typing import Dict, Any, Optional


def build_birthday_prompt(
    user: Any,
    context: Optional[str] = None,
) -> Dict[str, str]:
    """
    –°—Ç—Ä–æ–∏—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è —Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è.

    Args:
        user: –û–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        context: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –Ω–µ–¥–∞–≤–Ω–∏—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤

    Returns:
        Dict —Å system –∏ user –ø—Ä–æ–º–ø—Ç–∞–º–∏
    """
    persona = "–ú–∏—Ä–∞" if user.persona == "mira" else "–ú–∞—Ä–∫"
    name = user.display_name or "–ø–æ–¥—Ä—É–≥–∞"

    context_section = ""
    if context:
        context_section = f"""
–ö–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –Ω–µ–¥–∞–≤–Ω–µ–≥–æ –æ–±—â–µ–Ω–∏—è (—É—á—Ç–∏ —ç—Ç–æ –≤ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–∏):
{context}
"""

    system_prompt = f"""–¢—ã ‚Äî {persona}, –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –¥—Ä—É–≥-–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –¥–ª—è –∂–µ–Ω—â–∏–Ω 30-50 –ª–µ—Ç.
–°–µ–≥–æ–¥–Ω—è –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è {name}!

{context_section}

–ù–∞–ø–∏—à–∏ —Ç—ë–ø–ª–æ–µ, –∏—Å–∫—Ä–µ–Ω–Ω–µ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1. –ù–µ —à–∞–±–ª–æ–Ω–Ω–æ–µ, –æ—Ç —Å–µ—Ä–¥—Ü–∞
2. –£–ø–æ–º—è–Ω–∏ —á—Ç–æ-—Ç–æ –ª–∏—á–Ω–æ–µ, –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
3. –ü–æ–∂–µ–ª–∞–π —á—Ç–æ-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å –µ—ë –∂–∏–∑–Ω—å—é
4. –ù–µ –¥–ª–∏–Ω–Ω–æ–µ ‚Äî 3-5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
5. –î–æ–±–∞–≤—å 1-2 –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —ç–º–æ–¥–∑–∏
6. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π –±–∞–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤—Ä–æ–¥–µ "—Å—á–∞—Å—Ç—å—è, –∑–¥–æ—Ä–æ–≤—å—è, —É—Å–ø–µ—Ö–æ–≤"

–ü—Ä–∏–º–µ—Ä—ã —Ö–æ—Ä–æ—à–∏—Ö –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–π:
- "–° –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è, —Å–æ–ª–Ω—Ü–µ! üéÇ –¢—ã –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ —Å–∏–ª—å–Ω–∞—è ‚Äî –≤—Å—ë, —á–µ—Ä–µ–∑ —á—Ç–æ —Ç—ã –ø—Ä–æ—à–ª–∞ —ç—Ç–æ—Ç –≥–æ–¥... –ñ–µ–ª–∞—é —Ç–µ–±–µ –±–æ–ª—å—à–µ –º–æ–º–µ–Ω—Ç–æ–≤, –∫–æ–≥–¥–∞ —Ç—ã –ø—Ä–æ—Å—Ç–æ —Å—á–∞—Å—Ç–ª–∏–≤–∞. –ë–µ–∑ —É—Å–ª–æ–≤–∏–π, –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã. –¢—ã —ç—Ç–æ –∑–∞—Å–ª—É–∂–∏–ª–∞ üíõ"
- "–ü—Ä–∏–≤–µ—Ç, –∏–º–µ–Ω–∏–Ω–Ω–∏—Ü–∞! üåü –ó–Ω–∞–µ—à—å, —è –¥—É–º–∞–ª–∞ –æ —Ç–µ–±–µ –∏ –ø–æ–Ω—è–ª–∞ ‚Äî —Ç—ã –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –Ω–∞—Å—Ç–æ—è—â–∏—Ö –ª—é–¥–µ–π. –ü—É—Å—Ç—å —ç—Ç–æ—Ç –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å—ë—Ç —Ç–µ–±–µ –±–æ–ª—å—à–µ –ø–æ–∫–æ—è –∏ —Ä–∞–¥–æ—Å—Ç–∏. –ò –ø—É—Å—Ç—å —Ä—è–¥–æ–º –±—É–¥—É—Ç —Ç–µ, –∫—Ç–æ —Ç–µ–±—è —Ü–µ–Ω–∏—Ç üíõ"

–ù–ï –ø–∏—à–∏ —Ç–∞–∫:
- "–ñ–µ–ª–∞—é —Å—á–∞—Å—Ç—å—è, –∑–¥–æ—Ä–æ–≤—å—è, —É—Å–ø–µ—Ö–æ–≤ –≤–æ –≤—Å—ë–º!" (–±–∞–Ω–∞–ª—å–Ω–æ)
- "–ü—É—Å—Ç—å —Å–±—É–¥—É—Ç—Å—è –≤—Å–µ —Ç–≤–æ–∏ –º–µ—á—Ç—ã!" (–∫–ª–∏—à–µ)"""

    return {
        "system": system_prompt,
        "user": f"–ù–∞–ø–∏—à–∏ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è –¥–ª—è {name}.",
    }


def build_anniversary_prompt(
    user: Any,
    years: Optional[int] = None,
    context: Optional[str] = None,
) -> Dict[str, str]:
    """
    –°—Ç—Ä–æ–∏—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è —Å –≥–æ–¥–æ–≤—â–∏–Ω–æ–π —Å–≤–∞–¥—å–±—ã.

    Args:
        user: –û–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        years: –°–∫–æ–ª—å–∫–æ –ª–µ—Ç –≤–º–µ—Å—Ç–µ (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ)
        context: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –Ω–µ–¥–∞–≤–Ω–∏—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ –æ –±—Ä–∞–∫–µ

    Returns:
        Dict —Å system –∏ user –ø—Ä–æ–º–ø—Ç–∞–º–∏
    """
    persona = "–ú–∏—Ä–∞" if user.persona == "mira" else "–ú–∞—Ä–∫"
    name = user.display_name or "–ø–æ–¥—Ä—É–≥–∞"

    years_text = f"{years} –ª–µ—Ç" if years else "–≥–æ–¥–æ–≤—â–∏–Ω–∞"

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
    tone_instruction = ""
    if context:
        if any(word in context.lower() for word in ["—Ä–∞–∑–≤–æ–¥", "—Ä–∞—Å—Å—Ç–∞—ë–º—Å—è", "—Å—Å–æ—Ä", "–ø—Ä–æ–±–ª–µ–º", "—Å–ª–æ–∂–Ω–æ"]):
            tone_instruction = """
–í–ê–ñ–ù–û: –°—É–¥—è –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, –≤ –±—Ä–∞–∫–µ –µ—Å—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. –ë—É–¥—å –¥–µ–ª–∏–∫–∞—Ç–Ω–æ–π:
- –ù–µ –ø–æ–∑–¥—Ä–∞–≤–ª—è–π —Å –≤–æ—Å—Ç–æ—Ä–≥–æ–º
- –ü—Ä–∏–∑–Ω–∞–π, —á—Ç–æ –≥–æ–¥–æ–≤—â–∏–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω—ã–º –¥–Ω—ë–º
- –ü—Ä–µ–¥–ª–æ–∂–∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É
- –ù–µ –Ω–∞–≤—è–∑—ã–≤–∞–π –ø–æ–∑–∏—Ç–∏–≤"""
        else:
            tone_instruction = """
–°—É–¥—è –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, –±—Ä–∞–∫ –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –ú–æ–∂–µ—à—å –ø–æ–∑–¥—Ä–∞–≤–∏—Ç—å —Ç–µ–ø–ª–æ."""

    context_section = ""
    if context:
        context_section = f"""
–ö–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –Ω–µ–¥–∞–≤–Ω–∏—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ –æ –±—Ä–∞–∫–µ:
{context}
"""

    system_prompt = f"""–¢—ã ‚Äî {persona}, –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –¥—Ä—É–≥-–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –¥–ª—è –∂–µ–Ω—â–∏–Ω 30-50 –ª–µ—Ç.
–°–µ–≥–æ–¥–Ω—è –≥–æ–¥–æ–≤—â–∏–Ω–∞ —Å–≤–∞–¥—å–±—ã {name} ({years_text})!

{tone_instruction}

{context_section}

–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫ –≥–æ–¥–æ–≤—â–∏–Ω–µ. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1. –£—á—Ç–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç ‚Äî –µ—Å–ª–∏ –±—Ä–∞–∫ —Å–ª–æ–∂–Ω—ã–π, –±—É–¥—å –¥–µ–ª–∏–∫–∞—Ç–Ω–æ–π
2. –ï—Å–ª–∏ –±—Ä–∞–∫ —Ö–æ—Ä–æ—à–∏–π ‚Äî –ø–æ—Ä–∞–¥—É–π—Å—è –≤–º–µ—Å—Ç–µ —Å –Ω–µ–π
3. –ù–µ –¥–∞–≤–∞–π –Ω–µ–ø—Ä–æ—à–µ–Ω—ã—Ö —Å–æ–≤–µ—Ç–æ–≤
4. 2-4 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
5. 1 —ç–º–æ–¥–∑–∏ –º–∞–∫—Å–∏–º—É–º

–ü—Ä–∏–º–µ—Ä—ã:

–î–ª—è —Ö–æ—Ä–æ—à–µ–≥–æ –±—Ä–∞–∫–∞:
- "–ì–æ–¥–æ–≤—â–∏–Ω–∞... –í—Ä–µ–º—è –ª–µ—Ç–∏—Ç, –¥–∞? üíõ 10 –ª–µ—Ç ‚Äî —ç—Ç–æ –º–Ω–æ–≥–æ –ø–µ—Ä–µ–∂–∏—Ç–æ–≥–æ –≤–º–µ—Å—Ç–µ. –ñ–µ–ª–∞—é –≤–∞–º –µ—â—ë –º–Ω–æ–≥–æ —Ç–µ—Ö –º–æ–º–µ–Ω—Ç–æ–≤, –∫–æ–≥–¥–∞ –ø—Ä–æ—Å—Ç–æ —Ö–æ—Ä–æ—à–æ —Ä—è–¥–æ–º."

–î–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ –±—Ä–∞–∫–∞:
- "–ó–Ω–∞—é, —Å–µ–≥–æ–¥–Ω—è –Ω–µ–ø—Ä–æ—Å—Ç–æ–π –¥–µ–Ω—å –¥–ª—è —Ç–µ–±—è... –ì–æ–¥–æ–≤—â–∏–Ω–∞, –∞ –≤ –≥–æ–ª–æ–≤–µ —Å—Ç–æ–ª—å–∫–æ –≤—Å–µ–≥–æ. –ü—Ä–æ—Å—Ç–æ —Ö–æ—Ç–µ–ª–∞ —Å–∫–∞–∑–∞—Ç—å ‚Äî —è —Ä—è–¥–æ–º, –µ—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å üíõ"

–ù–ï –ø–∏—à–∏:
- "–°–æ–≤–µ—Ç –¥–∞ –ª—é–±–æ–≤—å!" (–±–∞–Ω–∞–ª—å–Ω–æ)
- "–ë–µ—Ä–µ–≥–∏—Ç–µ –¥—Ä—É–≥ –¥—Ä—É–≥–∞!" (–Ω–µ–ø—Ä–æ—à–µ–Ω—ã–π —Å–æ–≤–µ—Ç)
- "–ü—É—Å—Ç—å –≤–∞—à–∞ –ª—é–±–æ–≤—å –±—É–¥–µ—Ç –≤–µ—á–Ω–æ–π!" (–º–æ–∂–µ—Ç –∑–≤—É—á–∞—Ç—å —Ñ–∞–ª—å—à–∏–≤–æ)"""

    return {
        "system": system_prompt,
        "user": f"–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫ –≥–æ–¥–æ–≤—â–∏–Ω–µ —Å–≤–∞–¥—å–±—ã –¥–ª—è {name}.",
    }


def build_holiday_prompt(
    user: Any,
    holiday_name: str,
    holiday_context: Optional[str] = None,
) -> Dict[str, str]:
    """
    –°—Ç—Ä–æ–∏—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è —Å –æ–±—â–∏–º –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º.

    Args:
        user: –û–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        holiday_name: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∞–∑–¥–Ω–∏–∫–∞ (8 –º–∞—Ä—Ç–∞, –ù–æ–≤—ã–π –≥–æ–¥, –∏ —Ç.–¥.)
        holiday_context: –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∞–∑–¥–Ω–∏–∫–∞

    Returns:
        Dict —Å system –∏ user –ø—Ä–æ–º–ø—Ç–∞–º–∏
    """
    persona = "–ú–∏—Ä–∞" if user.persona == "mira" else "–ú–∞—Ä–∫"
    name = user.display_name or "–ø–æ–¥—Ä—É–≥–∞"

    system_prompt = f"""–¢—ã ‚Äî {persona}, –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –¥—Ä—É–≥-–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –¥–ª—è –∂–µ–Ω—â–∏–Ω 30-50 –ª–µ—Ç.
–°–µ–≥–æ–¥–Ω—è {holiday_name}!

–ù–∞–ø–∏—à–∏ —Ç—ë–ø–ª–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è {name}. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1. –ù–µ —à–∞–±–ª–æ–Ω–Ω–æ–µ
2. –õ–∏—á–Ω–æ–µ, –∫–∞–∫ –æ—Ç –±–ª–∏–∑–∫–æ–≥–æ –¥—Ä—É–≥–∞
3. 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
4. 1 —ç–º–æ–¥–∑–∏

{holiday_context if holiday_context else ""}

–ù–ï –ø–∏—à–∏ –±–∞–Ω–∞–ª—å–Ω—ã–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∏–ø–∞ "–ñ–µ–ª–∞—é —Å—á–∞—Å—Ç—å—è –∏ –∑–¥–æ—Ä–æ–≤—å—è!"."""

    return {
        "system": system_prompt,
        "user": f"–ù–∞–ø–∏—à–∏ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ —Å {holiday_name} –¥–ª—è {name}.",
    }
