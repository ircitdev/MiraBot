# ‚úÖ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã "API –†–∞—Å—Ö–æ–¥—ã: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"

**–î–∞—Ç–∞:** 30.12.2025
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–æ–±—Ä–∞–∂–∞–ª–æ—Å—å "API –†–∞—Å—Ö–æ–¥—ã: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"

## üîç –ß—Ç–æ –±—ã–ª–æ –Ω–∞–π–¥–µ–Ω–æ

–ü—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –ª–æ–≥–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞ –æ–±–Ω–∞—Ä—É–∂–∏–ª–æ—Å—å, —á—Ç–æ **–í–°–ï** –∑–∞–ø—Ä–æ—Å—ã –∫ API costs —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ 404 Not Found:

```
GET /api/adminapi-costs/users/1392513515 ‚Üí 404 Not Found ‚ùå
GET /api/adminapi-costs/users/summary ‚Üí 404 Not Found ‚ùå
GET /api/adminapi-costs/by-date ‚Üí 404 Not Found ‚ùå
GET /api/adminapi-costs/stats ‚Üí 404 Not Found ‚ùå
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: **`adminapi-costs`** - —ç—Ç–æ –æ–¥–Ω–æ —Å–ª–æ–≤–æ, –±–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è!

–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π URL: `/api/admin/api-costs/...` (—Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º `/`)

## üêõ –ü—Ä–∏—á–∏–Ω–∞ –±–∞–≥–∞

–í —Ñ–∞–π–ª–µ `admin.html` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `apiRequest()` (—Å—Ç—Ä–æ–∫–∞ 7654) URL –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–æ–≤–∞–ª—Å—è –±–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è:

```javascript
// –ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
const response = await fetch(`${API_BASE}${endpoint}`, {
```

–ì–¥–µ:
- `API_BASE = '/api/admin'` (–±–µ–∑ trailing slash)
- `endpoint = 'api-costs/users/123'` (–±–µ–∑ leading slash)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** `/api/admin` + `api-costs` = `/api/adminapi-costs` ‚ùå

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω —è–≤–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å `/`:

```javascript
// –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
const response = await fetch(`${API_BASE}/${endpoint}`, {
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** `/api/admin` + `/` + `api-costs` = `/api/admin/api-costs` ‚úÖ

## üöÄ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ñ–∞–π–ª `webapp/frontend/admin.html`
2. ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä
3. ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (`systemctl restart mira-webapp`)

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤–∞–º

### 1. –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —à–∞–≥!** –ë—Ä–∞—É–∑–µ—Ä –∫–µ—à–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª `admin.html`.

**–°–ø–æ—Å–æ–± 1 - –ñ–µ—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: http://mira.uspeshnyy.ru/admin
2. –ù–∞–∂–º–∏—Ç–µ `Ctrl + Shift + R` (–∏–ª–∏ `Ctrl + F5`)

**–°–ø–æ—Å–æ–± 2 - –ß–µ—Ä–µ–∑ DevTools:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
2. –ù–∞–∂–º–∏—Ç–µ `F12` (–æ—Ç–∫—Ä—ã—Ç—å DevTools)
3. –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫–µ "–û–±–Ω–æ–≤–∏—Ç—å" –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. –í—ã–±—Ä–∞—Ç—å "–û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –∏ –∂–µ—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞"

**–°–ø–æ—Å–æ–± 3 - –†–µ–∂–∏–º –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ:**
1. `Ctrl + Shift + N` (Chrome) –∏–ª–∏ `Ctrl + Shift + P` (Firefox)
2. –û—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –∫–µ—à–∞ –≤—Å—ë –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:

#### ‚úÖ –î–∞—à–±–æ—Ä–¥ (–≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞):

–ö–∞—Ä—Ç–æ—á–∫–∞ "API —Ä–∞—Å—Ö–æ–¥—ã":
```
API —Ä–∞—Å—Ö–æ–¥—ã
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ó–∞ –¥–µ–Ω—å:        $0.00
–ó–∞ –Ω–µ–¥–µ–ª—é:      $0.00
–ó–∞ –º–µ—Å—è—Ü:       $0.00
```
–î–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è —Ü–∏—Ñ—Ä—ã –≤–º–µ—Å—Ç–æ –ø—Ä–æ—á–µ—Ä–∫–æ–≤ `$-`

#### ‚úÖ –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

–ö–æ–ª–æ–Ω–∫–∞ "API":
- –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ —Ä–∞—Å—Ö–æ–¥–æ–≤: `$0.00`
- –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–∞—Å—Ö–æ–¥–∞–º–∏: `$X.XX` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `$0.12`)

#### ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–ª–∏–∫ –Ω–∞ –∏–º—è):

```
–î–µ—Ç–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –õ–∏–∑–∞
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Telegram ID: 1392513515

...

API –¢–æ–∫–µ–Ω–æ–≤:    0              ‚Üê –í–º–µ—Å—Ç–æ "‚Äî"
API –†–∞—Å—Ö–æ–¥—ã:    $0.00          ‚Üê –í–º–µ—Å—Ç–æ "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"
```

–ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å —Ä–∞—Å—Ö–æ–¥—ã:
```
API –¢–æ–∫–µ–Ω–æ–≤:    12,345
API –†–∞—Å—Ö–æ–¥—ã:    $1.23
                claude: $1.20, yandex_tts: $0.03
```

#### ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ ‚Üí –†–∞—Å—Ö–æ–¥—ã API:

- –ì—Ä–∞—Ñ–∏–∫ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ (7/30/90 –¥–Ω–µ–π) —Ä–∞–±–æ—Ç–∞—é—Ç

## üîß –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–ª–∞—Å—å

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ DevTools

–û—Ç–∫—Ä–æ–π—Ç–µ `F12` ‚Üí –≤–∫–ª–∞–¥–∫–∞ **Network** ‚Üí –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Üí –Ω–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –∫ `api-costs`:

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
- ‚úÖ `GET /api/admin/api-costs/stats` ‚Üí 200 OK (–∑–µ–ª—ë–Ω—ã–º)
- ‚úÖ `GET /api/admin/api-costs/by-date` ‚Üí 200 OK
- ‚úÖ `GET /api/admin/api-costs/users/summary` ‚Üí 200 OK

**–ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
- ‚ùå `GET /api/adminapi-costs/...` ‚Üí 404 Not Found (–∫—Ä–∞—Å–Ω—ã–º)

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ 404 - –∑–Ω–∞—á–∏—Ç –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–µ –æ—á–∏—Å—Ç–∏–ª—Å—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–µ–∂–∏–º –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ.

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω

```bash
ssh root@31.44.7.144
systemctl status mira-webapp
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Active: active (running)`

–ï—Å–ª–∏ –Ω–µ—Ç - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å:
```bash
systemctl restart mira-webapp
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç

–ü–æ –¥–∞–Ω–Ω—ã–º –∏–∑ –±–∞–∑—ã, –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –µ—Å—Ç—å —Ä–∞—Å—Ö–æ–¥—ã —Ç–æ–ª—å–∫–æ —É –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- **User ID:** 1
- **Telegram ID:** 65876198
- **–†–∞—Å—Ö–æ–¥—ã:** $0.00 (–æ–∫—Ä—É–≥–ª–µ–Ω–æ –¥–æ 2 –∑–Ω–∞–∫–æ–≤)

–û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç `$0.00` –ø–æ—Ç–æ–º—É —á—Ç–æ —É –Ω–∏—Ö –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ `api_costs`.

### –ö–æ–≥–¥–∞ –ø–æ—è–≤—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ?

–î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è—Ç—å—Å—è, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
1. –û—Ç–ø—Ä–∞–≤—è—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É ‚Üí Claude API —Å—Ç–æ–∏–º–æ—Å—Ç—å
2. –ü–æ–ª—É—á–∞—Ç –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí Yandex TTS —Å—Ç–æ–∏–º–æ—Å—Ç—å

–ö–∞–∂–¥–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `api_costs`.

## üìÑ –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

1. [CRITICAL_BUG_FIX_API_COSTS_URL.md](./CRITICAL_BUG_FIX_API_COSTS_URL.md) - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±–∞–≥–∞
2. [API_COSTS_BUGFIX.md](./API_COSTS_BUGFIX.md) - –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–≥—Ä–∞—Ñ–∏–∫ —Ä–∞—Å—Ö–æ–¥–æ–≤)
3. [FORCE_CACHE_REFRESH.md](./FORCE_CACHE_REFRESH.md) - —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –∫–µ—à–µ–º –±—Ä–∞—É–∑–µ—Ä–∞
4. [USER_DETAIL_API_COSTS_ERROR.md](./USER_DETAIL_API_COSTS_ERROR.md) - –ø–µ—Ä–≤–∏—á–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

## üéØ –ò—Ç–æ–≥

‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞**

–ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:
1. –ù–∞–π–¥–µ–Ω–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ URL –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏
2. –§–∞–π–ª –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
3. –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω

–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤–∞–º:
1. –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl + Shift + R)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ —Å–µ–∫—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã API costs —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ! üéâ
