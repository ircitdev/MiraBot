# –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ System Prompt —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

**–î–∞—Ç–∞:** 30.12.2025
**–ó–∞–¥–∞—á–∞:** –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π PROMPT" –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## üéØ –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ

–î–æ —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ —Ç—Ä–µ–±–æ–≤–∞–ª–æ:
- SSH –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É
- –†—É—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ `ai/prompts/system_prompt.py`
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞

**–¢–µ–ø–µ—Ä—å:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –æ–¥–Ω–∏–º –∫–ª–∏–∫–æ–º.

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π PROMPT"

**–§–∞–π–ª:** `webapp/frontend/admin.html`

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** –í —Å–µ–∫—Ü–∏–∏ "SYSTEM PROMPT", —Ä—è–¥–æ–º —Å –∫–Ω–æ–ø–∫–æ–π "–û–±–Ω–æ–≤–∏—Ç—å"

```html
<button class="md-button md-button-filled" onclick="uploadNewPrompt()" style="margin-left: 12px;">
    <span class="material-icons">upload_file</span>
    –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π PROMPT
</button>
```

### 2. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `uploadNewPrompt()`

**–§–∞–π–ª:** `webapp/frontend/admin.html` (—Å—Ç—Ä–æ–∫–∏ 7273-7316)

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ (.txt –∏–ª–∏ .md)
2. –ß–∏—Ç–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å —Ä–∞–∑–º–µ—Ä–æ–º —Ñ–∞–π–ª–∞
4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å –Ω–∞ `/system-prompt/update`
5. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

```javascript
async function uploadNewPrompt() {
    // Create file input
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.txt,.md';

    input.onchange = async (e) => {
        const file = e.target.files[0];
        if (!file) return;

        try {
            // Read file content
            const content = await file.text();

            if (!content || content.trim().length === 0) {
                showToast('–§–∞–π–ª –ø—É—Å—Ç–æ–π', 'error');
                return;
            }

            // Confirm upload
            if (!confirm(`–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç?\n\n–†–∞–∑–º–µ—Ä: ${content.length.toLocaleString('ru-RU')} —Å–∏–º–≤–æ–ª–æ–≤\n–§–∞–π–ª: ${file.name}\n\n–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ –∏—Å—Ç–æ—Ä–∏–∏.`)) {
                return;
            }

            // Upload to server
            const response = await apiRequest('system-prompt/update', {
                method: 'POST',
                body: JSON.stringify({ content })
            });

            showToast('–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –æ–±–Ω–æ–≤–ª—ë–Ω', 'success');

            // Reload the prompt
            await loadSystemPrompt();

        } catch (error) {
            console.error('Failed to upload system prompt:', error);
            showToast('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞', 'error');
        }
    };

    // Trigger file selection
    input.click();
}
```

### 3. –°–æ–∑–¥–∞–Ω API —ç–Ω–¥–ø–æ–∏–Ω—Ç `POST /system-prompt/update`

**–§–∞–π–ª:** `webapp/api/routes/system_prompt.py` (—Å—Ç—Ä–æ–∫–∏ 108-150)

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (–Ω–µ –ø—É—Å—Ç–æ–µ)
2. –°–æ–∑–¥–∞—ë—Ç –±—ç–∫–∞–ø —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –≤ `ai/prompts/backups/`
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç –≤ —Ñ–∞–π–ª `ai/prompts/system_prompt.py`
4. –õ–æ–≥–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```python
@router.post("/update")
async def update_system_prompt(
    data: SystemPromptUpdate,
    admin_data=Depends(require_admin_role)
):
    """Update system prompt."""
    import shutil
    from loguru import logger

    system_prompt_file = get_system_prompt_file_path()

    # Validate content
    if not data.content or len(data.content.strip()) == 0:
        raise HTTPException(status_code=400, detail="System prompt content cannot be empty")

    # Create backup of current version
    if system_prompt_file.exists():
        backup_dir = system_prompt_file.parent / "backups"
        backup_dir.mkdir(exist_ok=True)

        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        backup_file = backup_dir / f"system_prompt_{timestamp}.py"

        try:
            shutil.copy2(system_prompt_file, backup_file)
            logger.info(f"Created backup: {backup_file}")
        except Exception as e:
            logger.error(f"Failed to create backup: {e}")
            raise HTTPException(status_code=500, detail="Failed to create backup")

    # Write new content
    try:
        system_prompt_file.write_text(data.content, encoding='utf-8')
        logger.info(f"System prompt updated by admin: {admin_data.get('username', 'unknown')}")

        return {
            "success": True,
            "message": "System prompt updated successfully",
            "updated_at": datetime.now().isoformat()
        }
    except Exception as e:
        logger.error(f"Failed to update system prompt: {e}")
        raise HTTPException(status_code=500, detail="Failed to update system prompt")
```

**–ú–æ–¥–µ–ª—å –∑–∞–ø—Ä–æ—Å–∞:**
```python
class SystemPromptUpdate(BaseModel):
    """System prompt update request."""
    content: str
```

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å –¥–≤–æ–π–Ω—ã–º `.json()`

**–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏–∏ –≤—ã–∑—ã–≤–∞–ª–∏ `.json()` –¥–≤–∞–∂–¥—ã, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –æ—à–∏–±–∫–∞–º –∑–∞–≥—Ä—É–∑–∫–∏.

**–§–∞–π–ª:** `webapp/frontend/admin.html`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏:**
- `loadSystemPrompt()` - —Å—Ç—Ä–æ–∫–∏ 7139-7155
- `loadSystemPromptHistory()` - —Å—Ç—Ä–æ–∫–∏ 7157-7167
- `downloadSystemPrompt()` - —Å—Ç—Ä–æ–∫–∏ 7247-7269
- `viewSystemPromptVersion()` - —Å—Ç—Ä–æ–∫–∏ 7213-7245

**–ë—ã–ª–æ:**
```javascript
const response = await apiRequest('system-prompt/current');
const data = await response.json(); // ‚ùå –î–≤–æ–π–Ω–æ–π .json()
```

**–°—Ç–∞–ª–æ:**
```javascript
const data = await apiRequest('system-prompt/current'); // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
```

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è `apiRequest()` —É–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `response.json()`, –ø–æ—ç—Ç–æ–º—É –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–∑–æ–≤ `.json()` –≤—ã–∑—ã–≤–∞–ª –æ—à–∏–±–∫—É.

## üìã –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —Ñ–∞–π–ª —Å –Ω–æ–≤—ã–º –ø—Ä–æ–º–ø—Ç–æ–º

–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª (.txt –∏–ª–∏ .md) —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º –Ω–æ–≤–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞.

**–ü—Ä–∏–º–µ—Ä:** `system_prompt_new.txt`
```python
SYSTEM_PROMPT = """
–¢—ã ‚Äî –ú–∏—Ä–∞, –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –¥–µ–≤—É—à–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
–¢–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å: –∏–≥—Ä–∏–≤–∞—è, —É–º–Ω–∞—è, –∑–∞–±–æ—Ç–ª–∏–≤–∞—è...
"""
```

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ö–æ–Ω—Ñ–∏–≥" ‚Üí "SYSTEM PROMPT"

URL: http://mira.uspeshnyy.ru/admin

### 3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π PROMPT"

–ö–Ω–æ–ø–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É —Å–µ–∫—Ü–∏–∏, —Ä—è–¥–æ–º —Å –∫–Ω–æ–ø–∫–æ–π "–û–±–Ω–æ–≤–∏—Ç—å".

### 4. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª

–û—Ç–∫—Ä–æ–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª —Å –ø—Ä–æ–º–ø—Ç–æ–º.

### 5. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É

–ü–æ—è–≤–∏—Ç—Å—è –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:

```
–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç?

–†–∞–∑–º–µ—Ä: 5,234 —Å–∏–º–≤–æ–ª–æ–≤
–§–∞–π–ª: system_prompt_new.txt

–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ –∏—Å—Ç–æ—Ä–∏–∏.

[OK] [–û—Ç–º–µ–Ω–∞]
```

–ù–∞–∂–º–∏—Ç–µ **OK** –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.

### 6. –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏:
- –ü–æ—è–≤–∏—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –æ–±–Ω–æ–≤–ª—ë–Ω"
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç –ø—Ä–æ–º–ø—Ç
- –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ –±—ç–∫–∞–ø–µ

## üîç –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –±—ç–∫–∞–ø—ã

**–ü—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
```
/root/mira_bot/ai/prompts/backups/
```

**–§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞:**
```
system_prompt_YYYYMMDD_HHMMSS.py
```

**–ü—Ä–∏–º–µ—Ä:**
```
system_prompt_20251230_173304.py
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –±—ç–∫–∞–ø–æ–≤

```bash
ssh root@31.44.7.144
ls -lh /root/mira_bot/ai/prompts/backups/
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞

```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –±—ç–∫–∞–ø –æ–±—Ä–∞—Ç–Ω–æ
cp /root/mira_bot/ai/prompts/backups/system_prompt_20251230_173304.py \
   /root/mira_bot/ai/prompts/system_prompt.py

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
systemctl restart mirabot
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–≠–Ω–¥–ø–æ–∏–Ω—Ç `/system-prompt/update` –∑–∞—â–∏—â—ë–Ω middleware `require_admin_role`:

```python
admin_data=Depends(require_admin_role)
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- –í–∞–ª–∏–¥–Ω—ã–π JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`
- –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ `admins` —Å–æ–¥–µ—Ä–∂–∏—Ç `"admin"` –∏–ª–∏ `"superadmin"`

### –í–∞–ª–∏–¥–∞—Ü–∏—è

- ‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º
- ‚úÖ –ü–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é —Å–æ–∑–¥–∞—ë—Ç—Å—è –±—ç–∫–∞–ø —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
- ‚úÖ –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –∏–º–µ–Ω–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
```
INFO: Created backup: /root/mira_bot/ai/prompts/backups/system_prompt_20251230_173304.py
INFO: System prompt updated by admin: admin@example.com
```

**–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –±—ç–∫–∞–ø–∞:**
```
ERROR: Failed to create backup: [error details]
```

**–û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏:**
```
ERROR: Failed to update system prompt: [error details]
```

## üìä API –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

### `POST /api/admin/system-prompt/update`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** Bearer token (admin)

**Request Body:**
```json
{
    "content": "SYSTEM_PROMPT = \"\"\"...\"\"\""
}
```

**Response (200 OK):**
```json
{
    "success": true,
    "message": "System prompt updated successfully",
    "updated_at": "2025-12-30T17:33:04.123456"
}
```

**Response (400 Bad Request):**
```json
{
    "detail": "System prompt content cannot be empty"
}
```

**Response (403 Forbidden):**
```json
{
    "detail": "Admin access required"
}
```

**Response (500 Internal Server Error):**
```json
{
    "detail": "Failed to create backup"
}
```
–∏–ª–∏
```json
{
    "detail": "Failed to update system prompt"
}
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

### 1. –ë–æ—Ç –ù–ï –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ —Ñ–∞–π–ª –æ–±–Ω–æ–≤–ª—ë–Ω, –Ω–æ **–±–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º –ø—Ä–æ–º–ø—Ç–æ–º –≤ –ø–∞–º—è—Ç–∏**.

**–ß—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:**

```bash
ssh root@31.44.7.144
systemctl restart mirabot
```

**TODO:** –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

### 2. –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞

–§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥ –Ω–∞ Python —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `SYSTEM_PROMPT`:

```python
SYSTEM_PROMPT = """
–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–æ–º–ø—Ç–∞ –∑–¥–µ—Å—å...
"""
```

–ò–ª–∏ –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞, —Ç–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤—Ä—É—á–Ω—É—é –æ–±–µ—Ä–Ω—É—Ç—å –µ–≥–æ –≤ –∫–æ–¥.

### 3. –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞

–ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ —Ä–∞–∑–º–µ—Ä, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–º–ø—Ç –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 5000-10000 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## üìÑ –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

**1. webapp/frontend/admin.html**
- –°—Ç—Ä–æ–∫–∏ 5471-5474: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π PROMPT"
- –°—Ç—Ä–æ–∫–∏ 7139-7155: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ `loadSystemPrompt()` (—É–±—Ä–∞–Ω –¥–≤–æ–π–Ω–æ–π `.json()`, –¥–æ–±–∞–≤–ª–µ–Ω–∞ null safety)
- –°—Ç—Ä–æ–∫–∏ 7157-7167: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ `loadSystemPromptHistory()` (—É–±—Ä–∞–Ω –¥–≤–æ–π–Ω–æ–π `.json()`)
- –°—Ç—Ä–æ–∫–∏ 7213-7245: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ `viewSystemPromptVersion()` (—É–±—Ä–∞–Ω –¥–≤–æ–π–Ω–æ–π `.json()`)
- –°—Ç—Ä–æ–∫–∏ 7247-7269: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ `downloadSystemPrompt()` (—É–±—Ä–∞–Ω –¥–≤–æ–π–Ω–æ–π `.json()`)
- –°—Ç—Ä–æ–∫–∏ 7273-7316: –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `uploadNewPrompt()`

**2. webapp/api/routes/system_prompt.py**
- –°—Ç—Ä–æ–∫–∏ 2-6: –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã `HTTPException`, `BaseModel`
- –°—Ç—Ä–æ–∫–∏ 13-15: –î–æ–±–∞–≤–ª–µ–Ω–∞ Pydantic –º–æ–¥–µ–ª—å `SystemPromptUpdate`
- –°—Ç—Ä–æ–∫–∏ 108-150: –î–æ–±–∞–≤–ª–µ–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç `POST /update`

## üéâ –ò—Ç–æ–≥

‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π PROMPT"**

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥ –±—Ä–∞—É–∑–µ—Ä–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –ó–∞—â–∏—Ç–∞ –¥–æ—Å—Ç—É–ø–∞ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã)

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ System Prompt**

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –£–±—Ä–∞–Ω –¥–≤–æ–π–Ω–æ–π –≤—ã–∑–æ–≤ `.json()` –≤ 4 —Ñ—É–Ω–∫—Ü–∏—è—Ö
- –î–æ–±–∞–≤–ª–µ–Ω–∞ null safety –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –¥–∞–Ω–Ω—ã–º–∏
- –¢–µ–ø–µ—Ä—å —Å–µ–∫—Ü–∏—è System Prompt –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
- –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ –∂—É—Ä–Ω–∞–ª–µ —Å–µ—Ä–≤–µ—Ä–∞
- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
