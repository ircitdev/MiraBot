# –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–±—è –≤ –∞–¥–º–∏–Ω—ã

## –®–∞–≥ 1: –£–∑–Ω–∞–π—Ç–µ —Å–≤–æ–π Telegram ID

–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤:

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ –±–æ—Ç–∞ @userinfobot
1. –û—Ç–∫—Ä–æ–π—Ç–µ @userinfobot –≤ Telegram
2. –ù–∞–∂–º–∏—Ç–µ `/start`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à ID (—ç—Ç–æ —á–∏—Å–ª–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä: `123456789`)

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –±–æ—Ç–∞ @getmyid_bot
1. –û—Ç–∫—Ä–æ–π—Ç–µ @getmyid_bot –≤ Telegram
2. –ù–∞–∂–º–∏—Ç–µ `/start`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à ID

### –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /root/mira_bot
source venv/bin/activate
python

# –í Python –∫–æ–Ω—Å–æ–ª–∏:
from database.repositories.user import UserRepository
import asyncio

async def find_user():
    user_repo = UserRepository()
    # –ó–∞–º–µ–Ω–∏—Ç–µ "–≤–∞—à_username" –Ω–∞ –≤–∞—à Telegram username –±–µ–∑ @
    user = await user_repo.get_by_username("–≤–∞—à_username")
    if user:
        print(f"–í–∞—à Telegram ID: {user.telegram_id}")
    else:
        print("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")

asyncio.run(find_user())
```

## –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π ID –≤ —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `/root/mira_bot/webapp/api/routes/admin.py`:

```bash
nano /root/mira_bot/webapp/api/routes/admin.py
```

–ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É —Å `ADMIN_IDS` –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π ID:

```python
# –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ (telegram_id)
ADMIN_IDS = [
    getattr(settings, 'ADMIN_TELEGRAM_ID', 0),
    123456789,  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à Telegram ID
    # –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ telegram_id –¥—Ä—É–≥–∏—Ö –∞–¥–º–∏–Ω–æ–≤
]
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª (Ctrl+O, Enter, Ctrl+X).

## –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ WebApp

```bash
systemctl restart mira-webapp
systemctl status mira-webapp
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–∏—Å —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è (—Å—Ç–∞—Ç—É—Å `active (running)`).

## –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø

### –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä:
```
http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:8081/admin
```

### –ß–µ—Ä–µ–∑ Telegram WebApp:

–°–æ–∑–¥–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É –≤ –±–æ—Ç–µ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:

```python
from telegram import InlineKeyboardButton, InlineKeyboardMarkup

keyboard = [[
    InlineKeyboardButton(
        "üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å",
        web_app=WebAppInfo(url="http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:8081/admin")
    )
]]
reply_markup = InlineKeyboardMarkup(keyboard)
await update.message.reply_text("–ê–¥–º–∏–Ω –º–µ–Ω—é:", reply_markup=reply_markup)
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: –ß–µ—Ä–µ–∑ environment variable

1. –°–æ–∑–¥–∞–π—Ç–µ/–æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Ñ–∞–π–ª:
```bash
nano /root/mira_bot/.env
```

2. –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:
```
ADMIN_TELEGRAM_ID=123456789
```

3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `config/settings.py` –µ—Å—Ç—å:
```python
ADMIN_TELEGRAM_ID: int = Field(default=0, env='ADMIN_TELEGRAM_ID')
```

4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:
```bash
systemctl restart mira-webapp
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
2. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   - –°–∏—Å—Ç–µ–º–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (6 –∫–∞—Ä—Ç–æ—á–µ–∫ —Å —Ü–∏—Ñ—Ä–∞–º–∏)
   - –°—Ç—Ä–æ–∫—É –ø–æ–∏—Å–∫–∞
   - –¢–∞–±–ª–∏—Ü—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

3. –ï—Å–ª–∏ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –≤–∏–¥–∏—Ç–µ alert "–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω. –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤." - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —É–∫–∞–∑–∞–Ω –≤–∞—à Telegram ID
   - –ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ª–∏ —Å–µ—Ä–≤–∏—Å
   - –ù–µ—Ç –ª–∏ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö: `journalctl -u mira-webapp -n 50`

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–¥–º–∏–Ω–æ–≤

–ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ ID –≤ —Å–ø–∏—Å–æ–∫:

```python
ADMIN_IDS = [
    123456789,  # –ü–µ—Ä–≤—ã–π –∞–¥–º–∏–Ω
    987654321,  # –í—Ç–æ—Ä–æ–π –∞–¥–º–∏–Ω
    555555555,  # –¢—Ä–µ—Ç–∏–π –∞–¥–º–∏–Ω
]
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
- –ù–∏–∫–æ–º—É –Ω–µ —Å–æ–æ–±—â–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ Telegram ID –∞–¥–º–∏–Ω–æ–≤
- –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø–æ–ø—ã—Ç–æ–∫ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ production (–Ω–∞—Å—Ç—Ä–æ–π—Ç–µ nginx –∫–∞–∫ reverse proxy)
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è VPN –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–π Telegram ID —á–µ—Ä–µ–∑ –±–æ—Ç–∞ @userinfobot
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ ID –¥–æ–±–∞–≤–ª–µ–Ω –≤ `ADMIN_IDS`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `journalctl -u mira-webapp -f`

### –ü—Ä–æ–±–ª–µ–º–∞: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞: `systemctl status mira-webapp`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç: `netstat -tulpn | grep 8081`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall: `ufw status` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `journalctl -u mira-webapp -n 100`

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∞–Ω–Ω—ã–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∫–ª–∞–¥–∫—É Network –Ω–∞ –Ω–∞–ª–∏—á–∏–µ 403/500 –æ—à–∏–±–æ–∫
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∫–ª–∞–¥–∫—É Console –Ω–∞ –Ω–∞–ª–∏—á–∏–µ JavaScript –æ—à–∏–±–æ–∫
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ nginx –∫–∞–∫ reverse proxy (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)

```nginx
server {
    listen 80;
    server_name admin.your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:8081;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É `http://admin.your-domain.com/admin`
