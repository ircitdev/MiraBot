"""
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π.
–î—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏, —Ä–µ–ª–∞–∫—Å–∞—Ü–∏—è, –∑–∞–∑–µ–º–ª–µ–Ω–∏–µ.
"""

import random
from dataclasses import dataclass
from typing import List, Optional
from enum import Enum


class ExerciseCategory(Enum):
    BREATHING = "breathing"  # –î—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ
    RELAXATION = "relaxation"  # –†–µ–ª–∞–∫—Å–∞—Ü–∏—è
    GROUNDING = "grounding"  # –ó–∞–∑–µ–º–ª–µ–Ω–∏–µ
    QUICK = "quick"  # –ë—ã—Å—Ç—Ä—ã–µ (1-2 –º–∏–Ω)


@dataclass
class Exercise:
    """–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ."""
    id: str
    name: str
    category: ExerciseCategory
    duration_minutes: int
    description: str
    steps: List[str]
    when_to_use: str  # –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
    emoji: str = "üßò"


# === –î–´–•–ê–¢–ï–õ–¨–ù–´–ï –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø ===

BREATHING_EXERCISES = [
    Exercise(
        id="breathing_4_7_8",
        name="–î—ã—Ö–∞–Ω–∏–µ 4-7-8",
        category=ExerciseCategory.BREATHING,
        duration_minutes=3,
        description="–¢–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —É—Å–ø–æ–∫–æ–µ–Ω–∏—è –∏ —Å–Ω—è—Ç–∏—è —Ç—Ä–µ–≤–æ–≥–∏",
        steps=[
            "–°—è–¥—å —É–¥–æ–±–Ω–æ, —Ä–∞—Å—Å–ª–∞–±—å –ø–ª–µ—á–∏",
            "–í–¥–æ—Ö–Ω–∏ —á–µ—Ä–µ–∑ –Ω–æ—Å –Ω–∞ 4 —Å—á—ë—Ç–∞",
            "–ó–∞–¥–µ—Ä–∂–∏ –¥—ã—Ö–∞–Ω–∏–µ –Ω–∞ 7 —Å—á—ë—Ç–æ–≤",
            "–ú–µ–¥–ª–µ–Ω–Ω–æ –≤—ã–¥–æ—Ö–Ω–∏ —á–µ—Ä–µ–∑ —Ä–æ—Ç –Ω–∞ 8 —Å—á—ë—Ç–æ–≤",
            "–ü–æ–≤—Ç–æ—Ä–∏ 4 —Ä–∞–∑–∞",
        ],
        when_to_use="–¢—Ä–µ–≤–æ–≥–∞, –ø–∞–Ω–∏–∫–∞, –±–µ—Å—Å–æ–Ω–Ω–∏—Ü–∞",
        emoji="üå¨Ô∏è",
    ),
    Exercise(
        id="breathing_box",
        name="–ö–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ",
        category=ExerciseCategory.BREATHING,
        duration_minutes=4,
        description="–¢–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è",
        steps=[
            "–ü—Ä–µ–¥—Å—Ç–∞–≤—å –∫–≤–∞–¥—Ä–∞—Ç –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π",
            "–í–¥–æ—Ö –Ω–∞ 4 —Å—á—ë—Ç–∞ (—Ä–∏—Å—É–µ—à—å –ª–µ–≤—É—é —Å—Ç–æ—Ä–æ–Ω—É)",
            "–ó–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞ 4 —Å—á—ë—Ç–∞ (–≤–µ—Ä—Ö–Ω—è—è —Å—Ç–æ—Ä–æ–Ω–∞)",
            "–í—ã–¥–æ—Ö –Ω–∞ 4 —Å—á—ë—Ç–∞ (–ø—Ä–∞–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞)",
            "–ó–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞ 4 —Å—á—ë—Ç–∞ (–Ω–∏–∂–Ω—è—è —Å—Ç–æ—Ä–æ–Ω–∞)",
            "–ü–æ–≤—Ç–æ—Ä–∏ 4-6 —Ä–∞–∑",
        ],
        when_to_use="–°—Ç—Ä–µ—Å—Å, –Ω—É–∂–Ω–∞ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è",
        emoji="‚¨ú",
    ),
    Exercise(
        id="breathing_belly",
        name="–î—ã—Ö–∞–Ω–∏–µ –∂–∏–≤–æ—Ç–æ–º",
        category=ExerciseCategory.BREATHING,
        duration_minutes=5,
        description="–ì–ª—É–±–æ–∫–æ–µ –¥–∏–∞—Ñ—Ä–∞–≥–º–∞–ª—å–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ –¥–ª—è —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è",
        steps=[
            "–õ—è–≥ –∏–ª–∏ —Å—è–¥—å —É–¥–æ–±–Ω–æ",
            "–ü–æ–ª–æ–∂–∏ —Ä—É–∫—É –Ω–∞ –∂–∏–≤–æ—Ç",
            "–í–¥–æ—Ö–Ω–∏ –Ω–æ—Å–æ–º —Ç–∞–∫, —á—Ç–æ–±—ã –∂–∏–≤–æ—Ç –ø–æ–¥–Ω—è–ª—Å—è (–≥—Ä—É–¥—å –Ω–µ–ø–æ–¥–≤–∏–∂–Ω–∞)",
            "–ú–µ–¥–ª–µ–Ω–Ω–æ –≤—ã–¥–æ—Ö–Ω–∏ ‚Äî –∂–∏–≤–æ—Ç –æ–ø—É—Å–∫–∞–µ—Ç—Å—è",
            "–î—ã—à–∏ —Ç–∞–∫ 5 –º–∏–Ω—É—Ç",
        ],
        when_to_use="–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –≤ —Ç–µ–ª–µ, —Ö–æ—á–µ—Ç—Å—è —Ä–∞—Å—Å–ª–∞–±–∏—Ç—å—Å—è",
        emoji="ü´Å",
    ),
    Exercise(
        id="breathing_calm",
        name="–£—Å–ø–æ–∫–∞–∏–≤–∞—é—â–µ–µ –¥—ã—Ö–∞–Ω–∏–µ",
        category=ExerciseCategory.BREATHING,
        duration_minutes=2,
        description="–ë—ã—Å—Ç—Ä–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ ‚Äî –≤—ã–¥–æ—Ö –¥–ª–∏–Ω–Ω–µ–µ –≤–¥–æ—Ö–∞",
        steps=[
            "–í–¥–æ—Ö–Ω–∏ –Ω–∞ 3 —Å—á—ë—Ç–∞",
            "–í—ã–¥–æ—Ö–Ω–∏ –Ω–∞ 6 —Å—á—ë—Ç–æ–≤",
            "–ü–æ–≤—Ç–æ—Ä–∏ 5-10 —Ä–∞–∑",
            "–í—ã–¥–æ—Ö –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ 2 —Ä–∞–∑–∞ –¥–ª–∏–Ω–Ω–µ–µ –≤–¥–æ—Ö–∞",
        ],
        when_to_use="–ù—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ —É—Å–ø–æ–∫–æ–∏—Ç—å—Å—è",
        emoji="üòÆ‚Äçüí®",
    ),
]


# === –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø –ù–ê –†–ï–õ–ê–ö–°–ê–¶–ò–Æ ===

RELAXATION_EXERCISES = [
    Exercise(
        id="relax_progressive",
        name="–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —Ä–µ–ª–∞–∫—Å–∞—Ü–∏—è",
        category=ExerciseCategory.RELAXATION,
        duration_minutes=10,
        description="–ü–æ–æ—á–µ—Ä—ë–¥–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –∏ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ –º—ã—à—Ü",
        steps=[
            "–õ—è–≥ —É–¥–æ–±–Ω–æ, –∑–∞–∫—Ä–æ–π –≥–ª–∞–∑–∞",
            "–ù–∞—á–Ω–∏ —Å–æ —Å—Ç—É–ø–Ω–µ–π ‚Äî –Ω–∞–ø—Ä—è–≥–∏ –∏—Ö –Ω–∞ 5 —Å–µ–∫, –æ—Ç–ø—É—Å—Ç–∏",
            "–ò–∫—Ä—ã ‚Äî –Ω–∞–ø—Ä—è–≥–∏ –Ω–∞ 5 —Å–µ–∫, –æ—Ç–ø—É—Å—Ç–∏",
            "–ë—ë–¥—Ä–∞ ‚Äî –Ω–∞–ø—Ä—è–≥–∏, –æ—Ç–ø—É—Å—Ç–∏",
            "–ñ–∏–≤–æ—Ç ‚Äî –Ω–∞–ø—Ä—è–≥–∏, –æ—Ç–ø—É—Å—Ç–∏",
            "–ö—É–ª–∞–∫–∏ ‚Äî —Å–æ–∂–º–∏ –∫—Ä–µ–ø–∫–æ, –æ—Ç–ø—É—Å—Ç–∏",
            "–ü–ª–µ—á–∏ ‚Äî –ø–æ–¥–Ω–∏–º–∏ –∫ —É—à–∞–º, –æ—Ç–ø—É—Å—Ç–∏",
            "–õ–∏—Ü–æ ‚Äî –Ω–∞—Ö–º—É—Ä—å—Å—è, –æ—Ç–ø—É—Å—Ç–∏",
            "–ü–æ–ª–µ–∂–∏ –º–∏–Ω—É—Ç—É, —á—É–≤—Å—Ç–≤—É—è —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ",
        ],
        when_to_use="–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –≤ —Ç–µ–ª–µ, –Ω–µ –º–æ–∂–µ—à—å —Ä–∞—Å—Å–ª–∞–±–∏—Ç—å—Å—è",
        emoji="üßò‚Äç‚ôÄÔ∏è",
    ),
    Exercise(
        id="relax_body_scan",
        name="–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–ª–∞",
        category=ExerciseCategory.RELAXATION,
        duration_minutes=7,
        description="–û—Å–æ–∑–Ω–∞–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –∫–∞–∂–¥–æ–π —á–∞—Å—Ç–∏ —Ç–µ–ª–∞",
        steps=[
            "–õ—è–≥ –∏–ª–∏ —Å—è–¥—å —É–¥–æ–±–Ω–æ",
            "–ó–∞–∫—Ä–æ–π –≥–ª–∞–∑–∞, —Å–¥–µ–ª–∞–π 3 –≥–ª—É–±–æ–∫–∏—Ö –≤–¥–æ—Ö–∞",
            "–ù–∞–ø—Ä–∞–≤—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –º–∞–∫—É—à–∫—É",
            "–ú–µ–¥–ª–µ–Ω–Ω–æ ¬´—Å–∫–∞–Ω–∏—Ä—É–π¬ª –≤–Ω–∏–∑: –ª–æ–±, –≥–ª–∞–∑–∞, —â—ë–∫–∏, —á–µ–ª—é—Å—Ç—å",
            "–®–µ—è, –ø–ª–µ—á–∏, —Ä—É–∫–∏, –∫–∏—Å—Ç–∏",
            "–ì—Ä—É–¥—å, –∂–∏–≤–æ—Ç, —Å–ø–∏–Ω–∞",
            "–ë—ë–¥—Ä–∞, –∫–æ–ª–µ–Ω–∏, –≥–æ–ª–µ–Ω–∏, —Å—Ç—É–ø–Ω–∏",
            "–ó–∞–º–µ—á–∞–π –æ—â—É—â–µ–Ω–∏—è –±–µ–∑ –æ—Ü–µ–Ω–∫–∏",
        ],
        when_to_use="–ù—É–∂–Ω–æ –æ—Å–æ–∑–Ω–∞—Ç—å —Å–≤–æ—ë —Å–æ—Å—Ç–æ—è–Ω–∏–µ",
        emoji="üîç",
    ),
    Exercise(
        id="relax_safe_place",
        name="–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–µ—Å—Ç–æ",
        category=ExerciseCategory.RELAXATION,
        duration_minutes=5,
        description="–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Å—Ç–∞, –≥–¥–µ —Ç–µ–±–µ —Å–ø–æ–∫–æ–π–Ω–æ",
        steps=[
            "–ó–∞–∫—Ä–æ–π –≥–ª–∞–∑–∞, —Å–¥–µ–ª–∞–π –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥–ª—É–±–æ–∫–∏—Ö –≤–¥–æ—Ö–æ–≤",
            "–ü—Ä–µ–¥—Å—Ç–∞–≤—å –º–µ—Å—Ç–æ, –≥–¥–µ —Ç–µ–±–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏ —Å–ø–æ–∫–æ–π–Ω–æ",
            "–≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ –∏–ª–∏ –≤—ã–¥—É–º–∞–Ω–Ω–æ–µ –º–µ—Å—Ç–æ",
            "–†–∞—Å—Å–º–æ—Ç—Ä–∏ –¥–µ—Ç–∞–ª–∏: —Ü–≤–µ—Ç–∞, —Ñ–æ—Ä–º—ã",
            "–£—Å–ª—ã—à—å –∑–≤—É–∫–∏ —ç—Ç–æ–≥–æ –º–µ—Å—Ç–∞",
            "–ü–æ—á—É–≤—Å—Ç–≤—É–π –∑–∞–ø–∞—Ö–∏",
            "–û—â—É—Ç–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É, —Ç–µ–∫—Å—Ç—É—Ä—ã",
            "–ü–æ–±—É–¥—å —Ç–∞–º —Å—Ç–æ–ª—å–∫–æ, —Å–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ",
        ],
        when_to_use="–¢—Ä–µ–≤–æ–≥–∞, –Ω—É–∂–Ω–æ —É—Å–ø–æ–∫–æ–∏—Ç—å—Å—è",
        emoji="üè°",
    ),
]


# === –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø –ù–ê –ó–ê–ó–ï–ú–õ–ï–ù–ò–ï ===

GROUNDING_EXERCISES = [
    Exercise(
        id="ground_5_4_3_2_1",
        name="–¢–µ—Ö–Ω–∏–∫–∞ 5-4-3-2-1",
        category=ExerciseCategory.GROUNDING,
        duration_minutes=3,
        description="–í–æ–∑–≤—Ä–∞—Ç –≤ ¬´–∑–¥–µ—Å—å –∏ —Å–µ–π—á–∞—Å¬ª —á–µ—Ä–µ–∑ –æ—Ä–≥–∞–Ω—ã —á—É–≤—Å—Ç–≤",
        steps=[
            "–ù–∞–∑–æ–≤–∏ 5 –≤–µ—â–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –í–ò–î–ò–®–¨ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å",
            "–ù–∞–∑–æ–≤–∏ 4 –≤–µ—â–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–µ—à—å –ü–û–¢–†–û–ì–ê–¢–¨",
            "–ù–∞–∑–æ–≤–∏ 3 –∑–≤—É–∫–∞, –∫–æ—Ç–æ—Ä—ã–µ –°–õ–´–®–ò–®–¨",
            "–ù–∞–∑–æ–≤–∏ 2 –∑–∞–ø–∞—Ö–∞, –∫–æ—Ç–æ—Ä—ã–µ –ß–£–í–°–¢–í–£–ï–®–¨",
            "–ù–∞–∑–æ–≤–∏ 1 –≤–∫—É—Å –≤–æ —Ä—Ç—É",
        ],
        when_to_use="–ü–∞–Ω–∏–∫–∞, –¥–∏—Å—Å–æ—Ü–∏–∞—Ü–∏—è, —É–Ω–æ—Å–∏—Ç –≤ –º—ã—Å–ª–∏",
        emoji="üñêÔ∏è",
    ),
    Exercise(
        id="ground_feet",
        name="–ù–æ–≥–∏ –Ω–∞ –∑–µ–º–ª–µ",
        category=ExerciseCategory.GROUNDING,
        duration_minutes=2,
        description="–ë—ã—Å—Ç—Ä–æ–µ –∑–∞–∑–µ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –Ω–æ–≥–∏",
        steps=[
            "–ü–æ—Å—Ç–∞–≤—å –æ–±–µ –Ω–æ–≥–∏ –ø–ª–æ—Ç–Ω–æ –Ω–∞ –ø–æ–ª",
            "–ü–æ—á—É–≤—Å—Ç–≤—É–π –∫–æ–Ω—Ç–∞–∫—Ç —Å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å—é",
            "–ù–∞–¥–∞–≤–∏ —Å—Ç—É–ø–Ω—è–º–∏ –≤ –ø–æ–ª",
            "–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ –∫–æ—Ä–Ω–∏ —É—Ö–æ–¥—è—Ç –≤ –∑–µ–º–ª—é",
            "–î—ã—à–∏ –≥–ª—É–±–æ–∫–æ",
        ],
        when_to_use="–ù—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å",
        emoji="ü¶∂",
    ),
    Exercise(
        id="ground_cold_water",
        name="–•–æ–ª–æ–¥–Ω–∞—è –≤–æ–¥–∞",
        category=ExerciseCategory.GROUNDING,
        duration_minutes=1,
        description="–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –∑–∞–∑–µ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –æ—â—É—â–µ–Ω–∏—è",
        steps=[
            "–í–∫–ª—é—á–∏ —Ö–æ–ª–æ–¥–Ω—É—é –≤–æ–¥—É",
            "–ü–æ–¥–µ—Ä–∂–∏ —Ä—É–∫–∏ –ø–æ–¥ —Å—Ç—Ä—É—ë–π 30-60 —Å–µ–∫—É–Ω–¥",
            "–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ –æ—â—É—â–µ–Ω–∏–∏ —Ö–æ–ª–æ–¥–∞",
            "–ò–ª–∏ —É–º–æ–π—Å—è —Ö–æ–ª–æ–¥–Ω–æ–π –≤–æ–¥–æ–π",
        ],
        when_to_use="–ü–∞–Ω–∏–∫–∞, –Ω—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –ø—Ä–∏–π—Ç–∏ –≤ —Å–µ–±—è",
        emoji="üßä",
    ),
    Exercise(
        id="ground_object",
        name="–Ø–∫–æ—Ä–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç",
        category=ExerciseCategory.GROUNDING,
        duration_minutes=2,
        description="–ó–∞–∑–µ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Ç–∞–∫—Ç–∏–ª—å–Ω—ã–µ –æ—â—É—â–µ–Ω–∏—è",
        steps=[
            "–í–æ–∑—å–º–∏ –ª—é–±–æ–π –ø—Ä–µ–¥–º–µ—Ç –≤ —Ä—É–∫–∏",
            "–ò–∑—É—á–∞–π –µ–≥–æ –∫–∞–∫ –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑",
            "–ö–∞–∫–æ–π –æ–Ω –Ω–∞ –æ—â—É–ø—å? –ì–ª–∞–¥–∫–∏–π, —à–µ—Ä—à–∞–≤—ã–π?",
            "–ö–∞–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞? –í–µ—Å?",
            "–ö–∞–∫–æ–≥–æ —Ü–≤–µ—Ç–∞? –§–æ—Ä–º—ã?",
        ],
        when_to_use="–¢—Ä–µ–≤–æ–∂–Ω—ã–µ –º—ã—Å–ª–∏, –Ω—É–∂–Ω–æ –æ—Ç–≤–ª–µ—á—å—Å—è",
        emoji="ü™®",
    ),
]


# === –ë–´–°–¢–†–´–ï –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø ===

QUICK_EXERCISES = [
    Exercise(
        id="quick_shoulders",
        name="–°–±—Ä–æ—Å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è",
        category=ExerciseCategory.QUICK,
        duration_minutes=1,
        description="–ë—ã—Å—Ç—Ä–æ–µ —Å–Ω—è—Ç–∏–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è —Å –ø–ª–µ—á",
        steps=[
            "–ü–æ–¥–Ω–∏–º–∏ –ø–ª–µ—á–∏ –∫ —É—à–∞–º",
            "–ó–∞–¥–µ—Ä–∂–∏ –Ω–∞ 5 —Å–µ–∫—É–Ω–¥",
            "–†–µ–∑–∫–æ –æ–ø—É—Å—Ç–∏ –∏ —Ä–∞—Å—Å–ª–∞–±—å",
            "–ü–æ–≤—Ç–æ—Ä–∏ 3 —Ä–∞–∑–∞",
        ],
        when_to_use="–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –≤ –ø–ª–µ—á–∞—Ö –∏ —à–µ–µ",
        emoji="üí™",
    ),
    Exercise(
        id="quick_butterfly",
        name="–û–±—ä—è—Ç–∏–µ –±–∞–±–æ—á–∫–∏",
        category=ExerciseCategory.QUICK,
        duration_minutes=2,
        description="–¢–µ—Ö–Ω–∏–∫–∞ —Å–∞–º–æ—É—Å–ø–æ–∫–æ–µ–Ω–∏—è",
        steps=[
            "–°–∫—Ä–µ—Å—Ç–∏ —Ä—É–∫–∏ –Ω–∞ –≥—Ä—É–¥–∏ (–∫–∏—Å—Ç–∏ –Ω–∞ –ø–ª–µ—á–∞—Ö)",
            "–ü–æ–æ—á–µ—Ä—ë–¥–Ω–æ –ø–æ—Ö–ª–æ–ø—ã–≤–∞–π —Å–µ–±—è –ø–æ –ø–ª–µ—á–∞–º",
            "–ü—Ä–∞–≤–∞—è —Ä—É–∫–∞ ‚Äî –ª–µ–≤–æ–µ –ø–ª–µ—á–æ, –ª–µ–≤–∞—è ‚Äî –ø—Ä–∞–≤–æ–µ",
            "–ú–µ–¥–ª–µ–Ω–Ω–æ, —Ä–∏—Ç–º–∏—á–Ω–æ, –∫–∞–∫ –∫—Ä—ã–ª—å—è –±–∞–±–æ—á–∫–∏",
            "–î—ã—à–∏ –≥–ª—É–±–æ–∫–æ",
        ],
        when_to_use="–ù—É–∂–Ω–∞ —Å–∞–º–æ–ø–æ–¥–¥–µ—Ä–∂–∫–∞, —Ç—Ä–µ–≤–æ–≥–∞",
        emoji="ü¶ã",
    ),
    Exercise(
        id="quick_jaw",
        name="–†–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ —á–µ–ª—é—Å—Ç–∏",
        category=ExerciseCategory.QUICK,
        duration_minutes=1,
        description="–°–Ω—è—Ç–∏–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è —Å –ª–∏—Ü–∞",
        steps=[
            "–û—Ç–∫—Ä–æ–π —Ä–æ—Ç —à–∏—Ä–æ–∫–æ",
            "–ü–æ–¥–≤–∏–≥–∞–π —á–µ–ª—é—Å—Ç—å—é –≤–ª–µ–≤–æ-–≤–ø—Ä–∞–≤–æ",
            "–ü–æ–º–∞—Å—Å–∏—Ä—É–π –º–µ—Å—Ç–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —á–µ–ª—é—Å—Ç–µ–π",
            "–†–∞—Å—Å–ª–∞–±—å —è–∑—ã–∫, –ø–æ–ª–æ–∂–∏ –µ–≥–æ –Ω–∞ –Ω—ë–±–æ",
        ],
        when_to_use="–°–∂–∏–º–∞–µ—à—å –∑—É–±—ã, –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –≤ –ª–∏—Ü–µ",
        emoji="üòÆ",
    ),
]


# === –í–°–ï –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø ===

ALL_EXERCISES = (
    BREATHING_EXERCISES +
    RELAXATION_EXERCISES +
    GROUNDING_EXERCISES +
    QUICK_EXERCISES
)

EXERCISES_BY_ID = {ex.id: ex for ex in ALL_EXERCISES}
EXERCISES_BY_CATEGORY = {
    ExerciseCategory.BREATHING: BREATHING_EXERCISES,
    ExerciseCategory.RELAXATION: RELAXATION_EXERCISES,
    ExerciseCategory.GROUNDING: GROUNDING_EXERCISES,
    ExerciseCategory.QUICK: QUICK_EXERCISES,
}


def get_exercise_by_id(exercise_id: str) -> Optional[Exercise]:
    """–ü–æ–ª—É—á–∞–µ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –ø–æ ID."""
    return EXERCISES_BY_ID.get(exercise_id)


def get_exercises_by_category(category: ExerciseCategory) -> List[Exercise]:
    """–ü–æ–ª—É—á–∞–µ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏."""
    return EXERCISES_BY_CATEGORY.get(category, [])


def get_random_exercise(category: Optional[ExerciseCategory] = None) -> Exercise:
    """–ü–æ–ª—É—á–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ."""
    if category:
        exercises = EXERCISES_BY_CATEGORY.get(category, ALL_EXERCISES)
    else:
        exercises = ALL_EXERCISES
    return random.choice(exercises)


def get_exercise_for_state(state: str) -> Exercise:
    """
    –ü–æ–¥–±–∏—Ä–∞–µ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –ø–æ–¥ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

    Args:
        state: —Ç—Ä–µ–≤–æ–≥–∞, –ø–∞–Ω–∏–∫–∞, –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, –±–µ—Å—Å–æ–Ω–Ω–∏—Ü–∞, —Å—Ç—Ä–µ—Å—Å
    """
    state_lower = state.lower()

    if any(w in state_lower for w in ["–ø–∞–Ω–∏–∫", "—Å—Ç—Ä–∞—Ö", "—É–∂–∞—Å"]):
        # –ü—Ä–∏ –ø–∞–Ω–∏–∫–µ ‚Äî –∑–∞–∑–µ–º–ª–µ–Ω–∏–µ
        return random.choice([
            EXERCISES_BY_ID["ground_5_4_3_2_1"],
            EXERCISES_BY_ID["ground_cold_water"],
            EXERCISES_BY_ID["ground_feet"],
        ])

    if any(w in state_lower for w in ["—Ç—Ä–µ–≤–æ–≥", "–±–µ—Å–ø–æ–∫–æ–π", "–≤–æ–ª–Ω—É"]):
        # –ü—Ä–∏ —Ç—Ä–µ–≤–æ–≥–µ ‚Äî –¥—ã—Ö–∞–Ω–∏–µ –∏–ª–∏ –∑–∞–∑–µ–º–ª–µ–Ω–∏–µ
        return random.choice([
            EXERCISES_BY_ID["breathing_4_7_8"],
            EXERCISES_BY_ID["breathing_calm"],
            EXERCISES_BY_ID["ground_5_4_3_2_1"],
            EXERCISES_BY_ID["quick_butterfly"],
        ])

    if any(w in state_lower for w in ["–Ω–∞–ø—Ä—è–∂", "–∑–∞–∂–∞—Ç", "—Å–∫–æ–≤–∞–Ω"]):
        # –ü—Ä–∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–∏ ‚Äî —Ä–µ–ª–∞–∫—Å–∞—Ü–∏—è
        return random.choice([
            EXERCISES_BY_ID["relax_progressive"],
            EXERCISES_BY_ID["quick_shoulders"],
            EXERCISES_BY_ID["quick_jaw"],
        ])

    if any(w in state_lower for w in ["—Å–æ–Ω", "–±–µ—Å—Å–æ–Ω", "–∑–∞—Å–Ω"]):
        # –ü—Ä–∏ –±–µ—Å—Å–æ–Ω–Ω–∏—Ü–µ ‚Äî –º–µ–¥–ª–µ–Ω–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ
        return random.choice([
            EXERCISES_BY_ID["breathing_4_7_8"],
            EXERCISES_BY_ID["breathing_belly"],
            EXERCISES_BY_ID["relax_body_scan"],
        ])

    if any(w in state_lower for w in ["—Å—Ç—Ä–µ—Å—Å", "—É—Å—Ç–∞–ª", "–≤—ã–º–æ—Ç"]):
        # –ü—Ä–∏ —Å—Ç—Ä–µ—Å—Å–µ ‚Äî —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ
        return random.choice([
            EXERCISES_BY_ID["relax_safe_place"],
            EXERCISES_BY_ID["breathing_belly"],
            EXERCISES_BY_ID["quick_butterfly"],
        ])

    # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —á—Ç–æ-—Ç–æ –±—ã—Å—Ç—Ä–æ–µ
    return get_random_exercise(ExerciseCategory.QUICK)


def format_exercise(exercise: Exercise) -> str:
    """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏."""
    steps_text = "\n".join(f"  {i+1}. {step}" for i, step in enumerate(exercise.steps))

    return f"""{exercise.emoji} **{exercise.name}**

{exercise.description}

‚è± {exercise.duration_minutes} –º–∏–Ω

**–ö–∞–∫ –¥–µ–ª–∞—Ç—å:**
{steps_text}

üí° *–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:* {exercise.when_to_use}"""


def format_exercise_short(exercise: Exercise) -> str:
    """–ö—Ä–∞—Ç–∫–∏–π —Ñ–æ—Ä–º–∞—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è."""
    return f"{exercise.emoji} {exercise.name} ({exercise.duration_minutes} –º–∏–Ω)"
